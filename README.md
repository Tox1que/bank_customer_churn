# Отток клиентов  

### Описание проекта  
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте *F1*-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте *AUC-ROC*, сравнивайте её значение с *F1*-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)  

### Описание данных  
Признаки  
- `row_number` — индекс строки в данных  
- `customer_id` — уникальный идентификатор клиента  
- `surname` — фамилия  
- `credit_score` — кредитный рейтинг  
- `geography` — страна проживания  
- `gender` — пол  
- `age` — возраст  
- `tenure` — сколько лет человек является клиентом банка  
- `balance` — баланс на счёте  
- `num_of_products` — количество продуктов банка, используемых клиентом  
- `has_cr_card` — наличие кредитной карты  
- `is_active_member` — активность клиента  
- `estimated_salary` — предполагаемая зарплата  

Целевой признак  
- `exited` — факт ухода клиента.  

### Подготовка данных:  
- удалены переменные, не влияющие на целевой признак;   
- восстановлены данные в столбце `tenure`;  
- категориальные признаки преобразованы в численные.  

### Исследование задачи  
В ходе исследования было выполнено:  
- масштабирование признаков;  
- разделение данных на обучающую и тестовую выборки;  
- сравнение трёх моделей (критерий – *F1*-мера): решающего дерева, случайного леса и логистической регрессии.  

Модель на основе алгоритма случайного леса показала лучшие результаты, поэтому была выбрана для исследования методов увеличения качества при дисбалансе классов.

### Борьба с дисбалансом  

Было исследовано три метода увеличения качества модели:  
- увеличение выборки;
- уменьшение выборки;
- взвешивание классов.  

С точки зрения метрики *F1* на валидационной выборке методы расположились в следующем порядке:  
1. Взвешивание классов (*F1* = 0.624).  
2. Уменьшение выборки (*F1* = 0.624).  
3. Увеличение выборки (*F1* = 0.611).  
